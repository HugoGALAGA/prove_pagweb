<div id="proyectos" class="proyectos-section">
  <div class="container py-5">

    <div class="text-center">
      <h2 class="display-5 fw-bold mb-5 section-title">Proyectos</h2>
    </div>

    <div class="text-center mb-5">
      <button class= "btn-custom-primary" data-bs-toggle="modal" data-bs-target="#addProjectModal" (click)="abrirModalParaCrear()">
        <i class="fas fa-plus me-2"></i>
        Agregar Proyecto
      </button>
      
      <button class="btn btn-secondary ms-3" (click)="sincronizarConGitHub()">
        <i class="fab fa-github me-2"></i>
        Sincronizar con GitHub
      </button>
    </div>

    <div class="row">

      <div *ngFor="let proyecto of proyectos" class="col-md-6 col-lg-4 mb-4">
        
        <div class="card project-card h-100">

          <div class="card-actions">
            <button class="btn btn-sm btn-custom-pen btn-edit" 
                    data-bs-toggle="modal" 
                    data-bs-target="#addProjectModal" 
                    (click)="iniciarEdicion(proyecto)">
              <i class="fas fa-pencil-alt"></i>
            </button>
            <button class="btn btn-sm btn-danger btn-delete" (click)="eliminarProyecto(proyecto)">
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>

          <div class="img-container">
            <img [src]="proyecto.imgUrl" class="card-img-top" [alt]="proyecto.titulo">
          </div>
          
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ proyecto.titulo }}</h5>
            <p class="card-text">{{ proyecto.descripcion }}</p>
            
            <div class="tags">
              <span *ngFor="let tech of proyecto.tecnologias" class="tag">{{ tech }}</span>
            </div>

            <div class="mt-auto d-flex justify-content-between">
              <a [href]="proyecto.linkRepo" target="_blank" class="btn btn-custom-outline-dark"><i class="fab fa-github me-2"></i>Código</a>
              <a [href]="proyecto.linkDemo" target="_blank" class="btn btn-custom-outline-demo"><i class="fas fa-external-link-alt me-2"></i>Demo</a>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
</div>

<div class="modal fade" id="addProjectModal" tabindex="-1" aria-labelledby="addProjectModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addProjectModalLabel">
          <span *ngIf="!proyectoAEditar">Agregar Nuevo Proyecto</span>
          <span *ngIf="proyectoAEditar">Editar Proyecto</span>
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      
      <div class="modal-body">
        <form [formGroup]="proyectoForm" (ngSubmit)="guardarProyecto()">
          <div class="mb-3">
            <label for="titulo" class="form-label">Nombre *</label>
            <input type="text" class="form-control" id="titulo" formControlName="titulo">
          </div>
          <div class="mb-3">
            <label for="descripcion" class="form-label">Descripción *</label>
            <textarea class="form-control" id="descripcion" rows="3" formControlName="descripcion"></textarea>
          </div>
          <div class="mb-3">
            <label for="imgUrl" class="form-label">URL de Imagen</label>
            <input type="text" class="form-control" id="imgUrl" formControlName="imgUrl">
          </div>
          <div class="mb-3">
            <label for="tecnologias" class="form-label">Tecnologías (separadas por coma)</label>
            <input type="text" class="form-control" id="tecnologias" formControlName="tecnologias">
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="linkRepo" class="form-label">GitHub URL</label>
              <input type="text" class="form-control" id="linkRepo" formControlName="linkRepo">
            </div>
            <div class="col-md-6 mb-3">
              <label for="linkDemo" class="form-label">Demo URL</label>
              <input type="text" class="form-control" id="linkDemo" formControlName="linkDemo">
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="cancelarEdicion()">Cerrar</button>
        <button type="button" class="btn btn-primary" (click)="guardarProyecto()" [disabled]="proyectoForm.invalid">
          <span *ngIf="!proyectoAEditar">Agregar Proyecto</span>
          <span *ngIf="proyectoAEditar">Guardar Cambios</span>
        </button>
      </div>
    </div>
  </div>
</div>